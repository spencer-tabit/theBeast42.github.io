---
title: "final_project"
author: "Spencer Tabit"
date: "May 18, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(tidyr)
library(lubridate)
library(ggplot2)
library(purrr)
library(rvest)
library(magrittr)
library(stringr)
```



```{r message = FALSE, warning=FALSE}
setwd("~/College/CMSC320/Final Project/data/regularSeason")

files <- dir(pattern = "*.csv")

regular_seasons <- files %>%
  map(read_csv) %>%
  reduce(rbind)

regular_seasons
```
```{r message = FALSE, warning=FALSE}
all_nba_team_players_url <- "https://en.wikipedia.org/wiki/All-NBA_Team"

all_nba_team_players_data <- all_nba_team_players_url %>%
  read_html() %>%
  html_node("#mw-content-text > div > table:nth-child(24)") %>%
  html_table(fill=TRUE) %>%
  set_colnames(c("season", "first_players", "first_players_team", "second_players", "second_players_team", "third_players", "third_players_team")) %>%
  as_tibble()

all_nba_team_players_data <- all_nba_team_players_data %>%
  slice(2:151)

all_nba_team_first_data <- all_nba_team_players_data %>%
  select(season, first_players, first_players_team) %>%
  mutate(first_team = 1) %>%
  mutate(second_team = 0) %>%
  mutate(third_team = 0) %>%
  mutate(player = first_players) %>%
  mutate(team = first_players_team) %>%
  select(season, player, team, first_team, second_team, third_team)
  


all_nba_team_second_data <- all_nba_team_players_data %>%
  select(season, second_players, second_players_team) %>%
  mutate(first_team = 0) %>%
  mutate(second_team = 1) %>%
  mutate(third_team = 0) %>%
  mutate(player = second_players) %>%
  mutate(team = second_players_team) %>%
  select(season, player, team, first_team, second_team, third_team)

all_nba_team_third_data <- all_nba_team_players_data %>%
  select(season, third_players, third_players_team) %>%
  mutate(first_team = 0) %>%
  mutate(second_team = 0) %>%
  mutate(third_team = 1) %>%
  mutate(player = third_players) %>%
  mutate(team = third_players_team) %>%
  select(season, player, team, first_team, second_team, third_team)

all_nba_team_players_data <- all_nba_team_first_data %>%
  full_join(all_nba_team_second_data, by= c("season", "player", "team", "first_team", "second_team", "third_team")) %>%
  full_join(all_nba_team_third_data, by =c("season", "player", "team", "first_team", "second_team", "third_team")) %>%
  arrange(season)

all_nba_team_players_data <- all_nba_team_players_data %>%
  mutate(player = str_extract(player, "^(\\w|'|-)* [A-Za-z]*"))

all_nba_team_players_data
```  